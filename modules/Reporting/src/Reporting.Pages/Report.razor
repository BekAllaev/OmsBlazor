@using Microsoft.JSInterop
@using Microsoft.AspNetCore.Components
@using Reporting.Pages.Exceptions
@using Reporting.Pages.Services

@inject IJSRuntime JSRuntime
@inject NavigationManager NavigationManager

<div id="report-viewer" style="width: 100%;height: 950px"></div>

@code {
    [Parameter]
    public string? ReportName { get; set; }

    // ReportViewer options
    BoldReportViewerOptions viewerOptions = new BoldReportViewerOptions();

    // Used to render the Bold Report Viewer component in Blazor page.
    public async void RenderReportViewer()
    {
        if (string.IsNullOrWhiteSpace(ReportName))
        {
            throw new ReportNameIsNull();
        }

        viewerOptions.ReportName = ReportName;
        viewerOptions.ServiceURL = "/api/BoldReportsAPI";
        await JSRuntime.InvokeVoidAsync("BoldReports.RenderViewer", "report-viewer", viewerOptions);
    }

    // Initial rendering of Bold Report Viewer
    protected override void OnAfterRender(bool firstRender)
    {
        RenderReportViewer();
    }
}
